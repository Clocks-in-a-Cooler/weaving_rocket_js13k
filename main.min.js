var asteroid_density=.05,powerup_chance=.0015;function reset(){entities=[],game_state="menu",player=null,score=0}function start(){player=new Rocket,entities.push(player),game_state="playing",frames=0}function update(e){space_bar&KEY_PRESSED&&("menu"==game_state&&(start(),space_bar=KEY_SEEN),"game over"==game_state&&(reset(),space_bar=KEY_SEEN)),entities=entities.filter(e=>e.active),entities.forEach(t=>t.update(e,entities)),particles=particles.filter(e=>e.lifetime>0),particles.forEach(t=>t.update(e)),Math.random()<asteroid_density&&entities.push(new Asteroid(Math.random()*canvas_size,Math.floor(8*Math.random()+5),new Colour(255,255,255))),Math.random()<powerup_chance&&entities.push(new Powerup(Math.random()*canvas_size,["shield","gun","totem"][Math.floor(3*Math.random())],new Colour(255,0,0))),fire_gun&&(entities.push(new Bullet),fire_gun=!fire_gun),"playing"==game_state&&frames%60==0&&score++}var last_time=null;function animate(e){var t=null==last_time?0:e-last_time;t=Math.min(t,33),last_time=e,update(t),draw(entities,particles,context),requestAnimationFrame(animate)}requestAnimationFrame(animate);